{% extends "base.html" %}

{% block content %}


<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">
            Feedback <small>Manager</small>
        </h1>
        <ol class="breadcrumb">
            <li class="active">
                <i class="fa fa-dashboard"></i> Feedback Manager
            </li>
        </ol>
    </div>
</div>

 
  {% for category in main_categories %}

	  <div class="category-main">
	    <div class="panel panel-default">
	      <div class="panel-heading">
	        <h3> 
	         {{category.name}}
	        </h3>

	      </div>
	      <div class="panel-body">
	      	{% with category.id|get_subcategories as subcategories %}

	        	<h3> Subcategories</h3>
	        	<hr>

	        	<ul class="nav nav-pills">
        		{% for subcategory in subcategories %}
					
					 {% if forloop.first %}
					    	<li class="active"><a data-toggle="pill" href="#tab_sub_{{subcategory.id}}">{{subcategory.name}}</a></li>
					    {% else %}
					    	<li><a data-toggle="pill" href="#tab_sub_{{subcategory.id}}">{{subcategory.name}}</a></li>
				    {% endif %}
				{% endfor %}
			  	</ul>
			  	<hr>

			  	 <div class="tab-content">  

		  	 			
				  {% for subcategory in subcategories %}


				 	{% if forloop.first %}
				    <div id="tab_sub_{{subcategory.id}}" class="tab-pane fade in active">  
					{% else %}
					<div id="tab_sub_{{subcategory.id}}" class="tab-pane fade"> 
					{% endif %}			  	 	


        				 <h2> {{subcategory}} <a data-subcategory="{{subcategory}}" data-id="{{subcategory.id}}" data-toggle="modal" data-target="#edit_observation_" role="button" class="btn btn-success float-right-button newobservation">New Observation <i class="fa fa-fw fa-eye"></i></a></h2>        				 

		  	 		<table class="table table-striped table-hover">
				      <thead>
				        <tr>
				        	<th>	<h4> Type </h4> </th>
				          <th><h4> Observation <i class="fa fa-fw fa-eye"></i></h4></th>
				          
				        <!--   <th></th> -->
				          <th><h4>Feedback &amp; Explanations <i class="fa fa-fw fa-comment"></i> </h4></th>				    
				          	<th></th>
				        </tr>
				      </thead>
				      <tbody>        				 
        				{% for observation in subcategory|get_subcategory_observations %}
        				<tr>
			        				<td>
			        					{{observation.get_observation_type }}
			        				</td>				        				
				        			<td> 
			        					<p>           
			        						<a data-toggle="modal" data-target="#edit_observation_{{observation.id}}" role="button">{{observation }}</a> </p>


			        						{% include '_edit_observation_partial.html' %}   

			        				</td>

			        			
				        			<td>
				        				<ul>
				        					<a class="newfeedback" data-observation="{{observation.id}}" data-toggle="modal" data-id="{{subcategory.id}}" data-target="#edit_feedback_" role="button">Add New Feedback<i class="fa fa-fw fa-plus green-icon"></i></a> 
				        					  
				        					<hr>
				        				{% for feedback in observation|get_observation_feedbacks %}
				        				
				        					<li> 
				        						<p>
				        							<a data-toggle="modal" data-target="#edit_feedback_{{feedback.id}}" role="button">{{feedback }}</a> 
				        							| <a data-toggle="modal" data-target="#edit_explanation_" role="button"><i class="fa fa-fw fa-plus green-icon"></i></a> 
				        							| <a data-href="{% url "delete-common-feedback" feedback.id %}" data-toggle="modal" data-target="#confirm-delete-explanation" data-id="{{feedback}}" value="Delete" class="deleteexplanation"><i class="fa fa-fw fa-remove red-icon"></i></a> 
				        						</p>
			        						</li>
				        					{% include '_edit_common_feedback_partial.html' %}   
				        					<ul>
				        						
				        							{% include '_edit_explanation_partial.html' %}  

				        						{% for explanation in feedback|get_feedback_explanations %}
				        							<li> 
				        								<p> <!-- <i class="fa fa-fw fa-info-circle"></i> -->
				        									<a data-toggle="modal" data-target="#edit_explanation_{{explanation.id}}" role="button">{{explanation }}</a> 
				        									| <a data-href="{% url "delete-explanation" explanation.id %}" data-toggle="modal" data-target="#confirm-delete-explanation" data-id="{{explanation}}" value="Delete" class="deleteexplanation"><i class="fa fa-fw fa-remove red-icon"></i></a> 
				        									{% include '_edit_explanation_partial.html' %}   
				        								</p>
			        								</li>
				        						{% endfor %}
				        					</ul>
			        				
				        				{% endfor %}
				        			</ul>
			        				</td>
			        				<td>
<a href="#" data-href="{% url "delete-observation" observation.id %}" data-toggle="modal" data-target="#confirm-delete" data-id="{{observation.observation}}" value="Delete" class="float-right-button deleteobservation"><span class="fa fa-minus red-icon"></span></a>   
			        				</td>
			    					<!-- </div> -->
			    				<!-- </div> -->
 
						<!-- </div>	 -->	
						</tr>									    				       					
        				{% endfor %}
        			</tbody>
    				</table>
        			
    				</div>    				    				
    			
        		{% endfor %}
        		</div>

			{% endwith %}
			</div>	
		</div>	
	</div>	
<!-- 	</div>	 -->
	
	{% endfor %}
</div>	





<div class="modal fade" id="confirm-delete" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                Delete Observation
            </div>
            <div class="modal-body">
                <span> Are you sure you want to delete the observation: </span>
                 <b><span type="text" name="observationName" id="observationName"></span></b>
                 <span> ? </span>
            </div>
                 <div class="alert alert-warning" role="alert">
                  <span style="color: darkyellow;" class="fa fa-warning"></span>Warning! The feedbacks associated with this observation will also be deleted.
                  </div>            
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <a class="btn btn-danger btn-ok">Delete</a>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="confirm-delete-explanation" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                Delete Feedback or Explanation
            </div>
            <div class="modal-body">
                <span> Are you sure you want to delete the feedback or explanation: </span>
                 <b><span type="text" name="deleteName" id="deleteName"></span></b>
                 <span> ? </span>
            </div>
                 <div class="alert alert-warning" role="alert">
                  <span style="color: darkyellow;" class="fa fa-warning"></span>Warning! If this is a feedback, the explanations associated with this feedback will also be deleted.
                  </div>            
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <a class="btn btn-danger btn-ok">Delete</a>
            </div>
        </div>
    </div>
</div>

{% include '_edit_observation_partial.html' %}  

{% include '_edit_common_feedback_partial.html' %}


{% endblock %}